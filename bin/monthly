#!/bin/bash

RED="$(tput setaf 1)"
GREEN="$(tput setaf 2)"
YELLOW="$(tput setaf 3)"
BLUE="$(tput setaf 4)"
BOLD="$(tput bold)"
NORMAL="$(tput sgr0)"

# Matches the jrnl locations
JRNL_DIR=~/Dropbox/jrnl
YEAR=$(date +%Y)
MONTH_NUM=$(date +%m)
MONTH_NAME=$(date +%b)
NUM_OF_DAYS=$(cal $(date +"%m %Y") | awk 'NF {DAYS = $NF}; END {print DAYS}')
RANGE=$(seq 1 $NUM_OF_DAYS)

DIR="$JRNL_DIR/$YEAR/$MONTH_NUM"
FILE="$DIR/00.txt"

days=$(for d in $(seq -f "%02g" 1 $NUM_OF_DAYS); do
  echo "$d: "
done)

template=$(cat <<EOF

$MONTH_NAME / $YEAR

Goals
-----

Days
-----
$days

EOF)

echo "$template"

mkdir -p "$DIR"
printf "${GREEN}[ok]${NORMAL} Made ${DIR}\n"

if test -f "$FILE"; then
  nvim $FILE
else
  echo "$template" > "$FILE"
  printf "${GREEN}[ok]${NORMAL} made ${FILE}\n"
fi
